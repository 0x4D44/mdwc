# Coverage Analysis Report
**Date:** 2026-01-03
**Subject:** Initial Code Coverage Review

## Summary
The current codebase has basic unit test coverage for plain text file processing and core word counting logic. However, significant portions of the application, particularly format-specific handlers (PDF, DOCX) and the CLI entry point/formatting logic, are entirely untested.

**Estimated Coverage:** ~40-50% of logic lines.

## Detailed Findings

### Covered Areas
*   **Text File Processing:** `count_words_in_file` is tested for `.txt` files.
*   **Word Counting Logic:** Tokenization, casing, and unique word counting are verified.
*   **Glob Pattern Matching:** `process_files` is tested for basic pattern matching.

### Uncovered Areas (Gaps)
1.  **PDF Extraction (`extract_file_content` -> `pdf` branch)**
    *   Lines 26-29.
    *   Reason: No PDF files used in tests.
2.  **DOCX Extraction (`extract_docx_text`)**
    *   Lines 30-33, 43-54.
    *   Reason: No DOCX files used in tests. Requires constructing a valid ZIP/XML structure.
3.  **CLI Orchestration (`main`)**
    *   Lines 125-214.
    *   Reason: `main` function is not invoked by tests. Contains argument parsing, error reporting, and result formatting loop.
4.  **Formatting Helpers**
    *   `format_number`: Lines 100-112.
    *   `format_filename`: Lines 115-123.
    *   Reason: These are helper functions used only by `main`.
5.  **Error Handling Paths**
    *   Glob errors or file access errors during iteration are partially covered but specific error printing lines are not.

## Recommendations
To achieve high coverage (>98%), we need to:
1.  Test helper functions in isolation.
2.  Synthesize a dummy DOCX file in tests to verify the XML stripping logic.
3.  Refactor `main` into a testable `run()` function that accepts arguments and a writer (for stdout capturing). This will allow verifying the output format and control flow.
4.  Consider refactoring the PDF extractor to be mockable, or (if feasible) include a minimal test PDF resource.
